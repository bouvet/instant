!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("rxjs"),require("@angular/material"),require("@angular/common"),require("@angular/forms"),require("@angular/cdk/collections"),require("@angular/router"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("instant",["exports","@angular/core","rxjs","@angular/material","@angular/common","@angular/forms","@angular/cdk/collections","@angular/router","rxjs/operators"],e):e(t.instant={},t.ng.core,t.rxjs,t.ng.material,t.ng.common,t.ng.forms,t.ng.cdk.collections,t.ng.router,t.rxjs.operators)}(this,function(t,n,e,o,r,a,i,f,l){"use strict";var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function s(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,a=n.call(t),i=[];try{for(;(void 0===e||0<e--)&&!(o=a.next()).done;)i.push(o.value)}catch(l){r={error:l}}finally{try{o&&!o.done&&(n=a["return"])&&n.call(a)}finally{if(r)throw r.error}}return i}var u=function(){function t(){this.filterable=!0,this.sortable=!0,this.filter=new e.ReplaySubject}return t.prototype.ngOnInit=function(){null==this.label&&(this.label=this.name)},t.prototype.setFilter=function(t){t!==this.oldFilter&&(this.filter.next({active:this.name,filter:t}),this.filterValue=t,this.oldFilter=t),this.filterOpen=!1},t.decorators=[{type:n.Directive,args:[{selector:"instant-column"}]}],t.ctorParameters=function(){return[]},t.propDecorators={name:[{type:n.Input}],label:[{type:n.Input}],filterable:[{type:n.Input}],sortable:[{type:n.Input}],filterRef:[{type:n.ContentChild,args:["filter"]}],cellRef:[{type:n.ContentChild,args:["cell"]}]},t}(),p=function(){function t(t){this.elRef=t,this.rowClicked=new n.EventEmitter}return Object.defineProperty(t.prototype,"displayedColumns",{get:function(){return this._displayedColumns=this._displayedColumns||(this.columns?this.columns.map(function(t){return t.name}):null)},set:function(t){this._displayedColumns=t},enumerable:!0,configurable:!0}),t.prototype.ngAfterContentInit=function(){this.columns&&this.columns.length&&this.dataSource.db._configure({sortChange:this.sort.sortChange,filterChange:e.merge.apply(void 0,function t(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}(this.columns.map(function(t){return t.filter})))})},t.prototype.ngOnDestroy=function(){this.subscriptions&&this.subscriptions.length&&this.subscriptions.map(function(t){return t.unsubscribe()})},t.prototype.onRowClicked=function(t,e){if(null===e.target.closest("instant-grid-row-menu")){var n=[].slice.call(e.target.closest("mat-cell").classList).find(function(t){return-1<t.indexOf("mat-column-")}).substr("mat-column-".length);this.rowClicked.emit({data:t,colName:n})}},t.prototype.onClick=function(e){var n=[].slice.call(this.elRef.nativeElement.querySelectorAll("mat-header-cell")).filter(function(t){return!t.contains(e.target)}).map(function(t){return[].slice.call(t.classList).find(function(t){return-1<t.indexOf("mat-column-")}).substr("mat-column-".length)});this.columns.filter(function(t){return n.includes(t.name)}).forEach(function(t){return t.filterOpen=!1})},t.prototype.checkClose=function(t,e){"Enter"===t.key&&e.closeMenu()},t.decorators=[{type:n.Component,args:[{selector:"instant-grid",template:'<mat-table #table [dataSource]="dataSource" matSort>\n  <ng-container *ngFor="let col of columns" [matColumnDef]="col.name">\n    \x3c!-- Header definition --\x3e\n    <mat-header-cell *matHeaderCellDef>\n      <header>\n        <div class="action" *ngIf="col.filterable != false">\n          <mat-menu #appMenu="matMenu">\n            <ng-container *ngIf="col.filterRef; else defaultFilterTemplate">\n              <ng-container *ngTemplateOutlet="col.filterRef;context:{col:col}"></ng-container>\n            </ng-container>\n\n            <ng-template #defaultFilterTemplate>\n              <mat-form-field class="no-padding">\n                <input matInput placeholder="Filter" (click)="$event.stopPropagation()" (keyup)="checkClose($event, menuTrigger)"  [(ngModel)]="col.filterValue" [ngModelOptions]="{standalone:true}" (change)="col.setFilter(col.filterValue)">\n                <button mat-icon-button matSuffix (click)="col.setFilter(undefined)">\n                  <i class="fa far fa-times fa-fw"></i>\n                </button>\n              </mat-form-field>\n            </ng-template>\n          </mat-menu>\n          <button mat-icon-button [matMenuTriggerFor]="appMenu" #menuTrigger="matMenuTrigger">\n            <i class="fa far fa-fw fa-filter"></i>\n          </button>\n        </div>\n        <div mat-sort-header class="flex-col" role="heading" *ngIf="col.sortable != false">\n          {{ col.label }}\n        </div>\n        <div class="flex-col" role="heading" *ngIf="col.sortable == false">\n          {{ col.label }}\n        </div>\n      </header>\n    </mat-header-cell>\n\n    \x3c!-- Cell definition --\x3e\n    <mat-cell *matCellDef="let element">\n      <ng-container *ngIf="col.cellRef; else defaultCellTemplate">\n        <ng-container *ngTemplateOutlet="col.cellRef;context:{row:element,col:col.name}"></ng-container>\n      </ng-container>\n\n      <ng-template #defaultCellTemplate>\n        {{ element[col.name] }}\n      </ng-template>\n    </mat-cell>\n  </ng-container>\n\n  <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>\n  <mat-row *matRowDef="let row; columns: displayedColumns;let index=index;"\n           [ngClass]="{highlight: index === selectedIndex}"\n           [attr.data-rowIndex]="index"\n           (click)="onRowClicked(row, $event)"></mat-row>\n</mat-table>\n',styles:["[role=columnheader] header{position:relative;display:flex;align-items:center}[role=columnheader]:hover .action>button{visibility:visible}[role=columnheader] [role=heading]{flex:1}:host.striped [role=row]:nth-child(even){background:rgba(0,0,0,.02)}::ng-deep .mat-table{display:table!important;width:100%}::ng-deep .mat-table>.mat-header-row,::ng-deep .mat-table>.mat-row{display:table-row;padding:0;border:none}::ng-deep .mat-table>.mat-header-row>.mat-cell,::ng-deep .mat-table>.mat-header-row>.mat-header-cell,::ng-deep .mat-table>.mat-row>.mat-cell,::ng-deep .mat-table>.mat-row>.mat-header-cell{display:table-cell;height:48px;vertical-align:middle;border-bottom:1px solid rgba(0,0,0,.12);padding-left:3px}::ng-deep .mat-table>.mat-header-row>.mat-cell,::ng-deep .mat-table>.mat-row>.mat-cell{border-left:1px solid rgba(0,0,0,.12)}::ng-deep .no-padding{max-height:3rem;padding:0 16px;overflow:hidden}.action mat-menu{padding:0}.action mat-menu mat-form-field{width:100%;padding:0;margin:0}.mat-icon-button{width:18px}"]}]}],t.ctorParameters=function(){return[{type:n.ElementRef}]},t.propDecorators={dataSource:[{type:n.Input}],selectedIndex:[{type:n.Input}],columns:[{type:n.ContentChildren,args:[u]}],rowClicked:[{type:n.Output}],sort:[{type:n.ViewChild,args:[o.MatSort]}],displayedColumns:[{type:n.Input}],onClick:[{type:n.HostListener,args:["document:click",["$event"]]}]},t}(),d=function(){function t(){this.page=0,this.pageChange=new n.EventEmitter,this.total=0,this.pageSize=10,this.pageSizeOptions=[5,10,25,100]}return t.prototype.ngOnInit=function(){},t.prototype.pageHandler=function(t){this.pageSize=t.pageSize,this.page=t.pageIndex,this.pageChange.emit(t)},t.decorators=[{type:n.Component,args:[{selector:"instant-grid-toolbar",template:'<mat-toolbar>\n  <header>\n    <ng-content></ng-content>\n  </header>\n  <mat-paginator [length]="total" [pageSize]="pageSize" (page)="pageHandler($event)" [pageSizeOptions]="pageSizeOptions"> </mat-paginator>\n</mat-toolbar>\n',styles:["mat-toolbar header{flex:1}.mat-paginator{background:0 0}"]}]}],t.ctorParameters=function(){return[]},t.propDecorators={page:[{type:n.Input}],pageChange:[{type:n.Output}],total:[{type:n.Input}],pageSize:[{type:n.Input}],pageSizeOptions:[{type:n.Input}]},t}(),m=function(){function t(t){this.grid=t,this.icon="ellipsis-v",this.showMenu=!1}return t.prototype.ngOnInit=function(){},t.prototype.onClick=function(e){var o=this;[].slice.call(this.grid.elRef.nativeElement.querySelectorAll("mat-cell.mat-column-actions")).filter(function(t){return!t.contains(e.target)}).forEach(function(t){var e=t.closest("mat-row"),n=[].slice.call(e.closest("mat-table").children).indexOf(e)-1;o.grid.dataSource.db.dataSnapshot[n].showMenu=!1})},t.decorators=[{type:n.Component,args:[{selector:"instant-grid-row-menu",template:'<mat-menu #rowMenu="matMenu">\n  <ng-content></ng-content>\n</mat-menu>\n\n<button type="button" mat-icon-button [matMenuTriggerFor]="rowMenu">\n  <i class="fa far fa-fw fa-{{ icon }}"></i>\n</button>\n',styles:[":host{position:relative}mat-card{position:absolute;z-index:100;right:0}"]}]}],t.ctorParameters=function(){return[{type:p}]},t.propDecorators={row:[{type:n.Input}],icon:[{type:n.Input}],onClick:[{type:n.HostListener,args:["document:click",["$event"]]}]},t}(),g=function(){function t(){}return t.decorators=[{type:n.NgModule,args:[{imports:[r.CommonModule,a.FormsModule,o.MatTableModule,o.MatSortModule,o.MatInputModule,o.MatCardModule,o.MatMenuModule,o.MatButtonModule,o.MatToolbarModule,o.MatPaginatorModule],declarations:[p,u,d,m],exports:[p,u,d,m]}]}],t}(),h=function(n){function t(t){var e=n.call(this)||this;return e.db=t,e}return function e(t,e){function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(t,n),t.prototype.connect=function(){return this.db.dataChange},t.prototype.disconnect=function(){this.db.onDestroy()},t}(i.DataSource),b=function(){function t(){this.sortCache={},this.filterChange=new e.BehaviorSubject(null),this.filterCache={},this.dataChange=new e.BehaviorSubject([])}return t.prototype.onInit=function(){var e=this;this.onRead(),this._dataChangeSubscriber=this.dataChange.subscribe(function(t){return e.dataSnapshot=t})},t.prototype.onDestroy=function(){this._dataChangeSubscriber.unsubscribe(),this._sortSubscriber.unsubscribe(),this._filterSubscriber.unsubscribe()},t.prototype.onRead=function(t,e){},t.prototype._configure=function(t){var e=this;Object.assign(this,t),this._sortSubscriber=this.sortChange.subscribe(function(t){e.sortCache={},e.sortCache[t.active]=t.direction,e.onRead(e.sortCache,e.filterCache)}),this._filterSubscriber=this.filterChange.subscribe(function(t){e.filterCache[t.active]=t.filter,e.onRead(e.sortCache,e.filterCache)}),this.onInit&&this.onInit()},t}(),y=function(){function t(t,e){this.route=t,this.router=e,this.subscriptions=[]}return t.prototype.ngOnInit=function(){var n=this;this.subscriptions.push(this.router.events.pipe(l.filter(function(t){return t instanceof f.NavigationEnd})).subscribe(function(t){console.log("url changed");var e=n.route.root;n.routeMap=n.getBreadcrumbs(e)}))},t.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(t){t&&t.unsubscribe()})},t.prototype.getBreadcrumbs=function(t,e,n){void 0===e&&(e=""),void 0===n&&(n=[]);var o,r,a="breadcrumb",i=t.children;if(0===i.length)return n;try{for(var l=function c(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}(i),s=l.next();!s.done;s=l.next()){var u=s.value;if(u.outlet===f.PRIMARY_OUTLET){if(!u.snapshot.data.hasOwnProperty(a))return this.getBreadcrumbs(u,e,n);e+="/"+u.snapshot.url.map(function(t){return t.path}).join("/");var p={label:u.snapshot.data[a],params:u.snapshot.params,url:e};return n.push(p),this.getBreadcrumbs(u,e,n)}}}catch(d){o={error:d}}finally{try{s&&!s.done&&(r=l["return"])&&r.call(l)}finally{if(o)throw o.error}}},t.decorators=[{type:n.Component,args:[{selector:"instant-breadcrumb",template:'<a [routerLink]="[\'/\']"><i class="fa far fa-fw fa-home"></i></a>\n<a *ngFor="let route of routeMap" [routerLink]="[route.url]">{{ route.label }}</a>\n',styles:[":host{flex:1}"]}]}],t.ctorParameters=function(){return[{type:f.ActivatedRoute},{type:f.Router}]},t}(),v=function(){function t(){}return t.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=n.defineInjectable({factory:function e(){return new t},token:t,providedIn:"root"}),t}(),C=function(){function t(t){this.toolbarService=t}return Object.defineProperty(t.prototype,"actionsRef",{get:function(){return this.toolbarService.actionTemplate},enumerable:!0,configurable:!0}),t.decorators=[{type:n.Component,args:[{selector:"instant-form-actions",template:'<ng-container *ngIf="actionsRef; else defaultTemplate">\n  <ng-container *ngTemplateOutlet="actionsRef"></ng-container>\n</ng-container>\n\n<ng-template #defaultTemplate></ng-template>\n',styles:[""]}]}],t.ctorParameters=function(){return[{type:v}]},t}(),w=function(){function t(t,e){this.template=t,this.toolbar=e}return t.prototype.ngOnInit=function(){this.toolbar.actionTemplate=this.template},t.prototype.ngOnDestroy=function(){this.toolbar.actionTemplate=null},t.decorators=[{type:n.Directive,args:[{selector:"[instantFormActionsDef]"}]}],t.ctorParameters=function(){return[{type:n.TemplateRef},{type:v}]},t}(),x=function(){function t(){}return t.decorators=[{type:n.NgModule,args:[{imports:[r.CommonModule,f.RouterModule],declarations:[y,C,w],exports:[y,C,w],providers:[v]}]}],t}();t.GridModule=g,t.GridComponent=p,t.ColumnDirective=u,t.GridRowMenuComponent=m,t.InstantDataSource=h,t.InstantDatabase=b,t.ToolbarModule=x,t.BreadcrumbComponent=y,t.FormActionsComponent=C,t.FormActionsDefDirective=w,t.ToolbarService=v,t.ɵa=d,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=instant.umd.min.js.map